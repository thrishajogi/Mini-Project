<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Create Account – Zero Bank</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<style>
body{background:#f8f9fa;font-family:Arial, sans-serif}
.topbar{background:#fff;border-bottom:1px solid #ddd;padding:14px 24px;display:flex;align-items:center;justify-content:space-between}
.brand{font-weight:600}
.container-box{width:420px;margin:70px auto;background:#fff;padding:30px;border:1px solid #ddd;border-radius:6px}
.btn-blue{width:100%;background:#007bff;color:#fff;padding:10px;border:none;border-radius:4px;margin-top:14px}
.link{text-align:center;margin-top:10px}
.error{text-align:center;color:red;margin-top:10px}
.success{text-align:center;color:green;margin-top:10px}
small.note{display:block;margin-top:6px;color:#666}
</style>
</head>
<body>

<header class="topbar">
  <div class="brand">Zero Bank</div>
  <div><a href="signin.html">Sign In</a></div>
</header>

<div class="container-box">
  <h4 class="text-center">Create Account</h4>

  <label>Name</label>
  <input id="username" class="form-control" />

  <label>Email</label>
  <input id="email" class="form-control" />

  <label>Password</label>
  <input id="password" type="password" class="form-control" />
  <small class="note">Min 8 chars, uppercase, lowercase, number and symbol required</small>

  <label>Confirm Password</label>
  <input id="confirm" type="password" class="form-control" />

  <button type="button" class="btn-blue" onclick="register()">Sign Up</button>

  <div class="link">Already a user? <a href="signin.html">Sign In</a></div>

  <div id="msg" class="error"></div>
  <div id="success" class="success"></div>
</div>

<script>
// Client-side password check to give instant feedback
function isStrongPassword(password) {
  return (
    password.length >= 8 &&
    /[A-Z]/.test(password) &&
    /[a-z]/.test(password) &&
    /[0-9]/.test(password) &&
    /[^A-Za-z0-9]/.test(password)
  );
}

async function register(){
  const username = document.getElementById('username').value.trim();
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;
  const confirm = document.getElementById('confirm').value;
  const msg = document.getElementById('msg');
  const success = document.getElementById('success');
  msg.textContent = '';
  success.textContent = '';

  if(!username || !email || !password || !confirm){
    msg.textContent = 'Please fill all fields.';
    return;
  }
  if(password !== confirm){
    msg.textContent = 'Passwords do not match.';
    return;
  }
  if(!isStrongPassword(password)){
    msg.textContent = 'Password must be 8+ chars and include uppercase, lowercase, number and symbol.';
    return;
  }

  try {
    const res = await fetch('http://localhost:5000/signup',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ username, email, password })
    });

    const data = await res.json();
    if(!data.success){
      msg.textContent = data.error || 'Signup failed';
      return;
    }

    // Save email to localStorage for next step (security setup)
    localStorage.setItem('userEmail', email);

    success.textContent = "Signup successful — redirecting to Security Setup...";
    setTimeout(()=> {
      window.location.href = 'security.html';
    }, 900);
  } catch (err) {
    console.error(err);
    msg.textContent = "Server error.";
  }
}
</script>
</body>
</html>
